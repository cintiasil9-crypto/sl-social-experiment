<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üèÜ SL Social Experiment Leaderboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background: #faf7f2;
  margin: 0;
  padding: 24px;
}

h1 {
  text-align: center;
  margin-bottom: 12px;
}

input {
  width: 100%;
  padding: 10px;
  margin-bottom: 14px;
  font-size: 16px;
}

table {
  width: 100%;
  border-collapse: collapse;
  background: #fff;
}

th, td {
  border: 1px solid #ddd;
  padding: 8px;
  font-size: 14px;
  text-align: left;
}

th {
  background: #eee;
  position: sticky;
  top: 0;
  z-index: 1;
}

tr:hover {
  background: #f3f3f3;
}

.bad {
  color: #b00020;
  font-weight: bold;
}

.small {
  font-size: 12px;
  color: #555;
}
</style>
</head>

<body>

<h1>üèÜ SL Social Experiment Leaderboard</h1>

<input id="search" placeholder="Search by avatar name‚Ä¶" />

<table>
<thead>
<tr>
  <th>#</th>
  <th>Name</th>
  <th>Confidence</th>
  <th>Reputation</th>
  <th>Gravity</th>
  <th>Role</th>
  <th>Archetype</th>

  <th>Engaging</th>
  <th>Curious</th>
  <th>Humorous</th>
  <th>Supportive</th>
  <th>Dominant</th>
  <th>Combative</th>

  <th>Flirty</th>
  <th>Sexual</th>
  <th>Curse</th>

  <th>Troll</th>
</tr>
</thead>

<tbody id="rows">
<tr><td colspan="18">Loading‚Ä¶</td></tr>
</tbody>
</table>

<script>
const API = "https://sl-gpt-relay.onrender.com/leaderboard";
let DATA = [];

fetch(API)
  .then(r => r.json())
  .then(json => {
    DATA = json;
    render(DATA);
  })
  .catch(() => {
    document.getElementById("rows").innerHTML =
      "<tr><td colspan='18'>Failed to load data</td></tr>";
  });

document.getElementById("search").addEventListener("input", e => {
  const q = e.target.value.toLowerCase();
  render(DATA.filter(r => r.name.toLowerCase().includes(q)));
});

function pct(v) {
  return (v ?? 0) + "%";
}

function render(list) {
  const body = document.getElementById("rows");
  body.innerHTML = "";

  list.forEach(p => {
    const t = p.traits || {};
    const s = p.styles || {};

    body.innerHTML += `
      <tr>
        <td>${p.rank}</td>
        <td>${p.name}</td>
        <td>${pct(p.confidence)}</td>
        <td>${pct(p.reputation)}</td>
        <td>${pct(p.gravity)}</td>
        <td>${p.role}</td>
        <td>${p.archetype}</td>

        <td>${pct(t.engaging)}</td>
        <td>${pct(t.curious)}</td>
        <td>${pct(t.humorous)}</td>
        <td>${pct(t.supportive)}</td>
        <td>${pct(t.dominant)}</td>
        <td>${pct(t.combative)}</td>

        <td>${pct(s.flirty)}</td>
        <td>${pct(s.sexual)}</td>
        <td>${pct(s.curse)}</td>

        <td class="${p.troll ? "bad" : ""}">
          ${p.troll ? "‚ö†Ô∏è YES" : ""}
        </td>
      </tr>`;
  });
}
</script>

</body>
</html>
